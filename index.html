<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>sonnerie.lucie.aubrac</title>
<link rel="stylesheet" href="CSS.css">
</head>
<body>

<h1>Propositions de sonneries pour le lycée Lucie Aubrac</h1>

<div id="adminLogin">
  <h3>Connexion Admin</h3>
  <input type="text" id="adminUsername" placeholder="Nom d'utilisateur">
  <input type="password" id="adminPassword" placeholder="Mot de passe">
  <button id="adminLoginBtn">Se connecter</button>
  <button id="logoutBtn" style="display:none;">Se déconnecter</button>
</div>


<form id="answerForm">
    <input type="text" id="answerInput" placeholder="ex: Teeth, Lady Gaga" required>
    <button type="submit">Envoyer</button>
</form>

<ul id="results"></ul>

<script type="module">
let isAdmin = false;

const ADMIN_USERNAME = "lucieA";
const ADMIN_PASSWORD = "Lucie2026";

let isAdmin = false;
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAYGY37Hd7R3Jbd9BRsOMb8cw6Vpeb4d8Q",
  authDomain: "sonnerie-lycee.firebaseapp.com",
  projectId: "sonnerie-lycee",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const adminLoginBtn = document.getElementById("adminLoginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const usernameInput = document.getElementById("adminUsername");
const passwordInput = document.getElementById("adminPassword");



let currentUser = null;

const loginBtn = document.getElementById("loginBtn");
const form = document.getElementById("answerForm");
const input = document.getElementById("answerInput");
const results = document.getElementById("results");

loginBtn.addEventListener("click", async () => {
  await signInWithPopup(auth, provider);
});

onAuthStateChanged(auth, (user) => {
  currentUser = user;
  displayAnswers();
});

async function displayAnswers() {
  results.innerHTML = "";
  const querySnapshot = await getDocs(collection(db, "propositions"));

  querySnapshot.forEach((docu) => {
    const li = document.createElement("li");
    li.textContent = docu.data().text;

   if (isAdmin)
      const deleteBtn = document.createElement("button");
      deleteBtn.textContent = "❌";
      deleteBtn.style.marginLeft = "10px";
     deleteBtn.addEventListener("click", async () => {
      const password = prompt("Mot de passe admin :");

     if (password === "monMotDePasseSecret") {
      await deleteDoc(doc(db, "propositions", docu.id));
      displayAnswers();
     } else {
    alert("Mot de passe incorrect !");
     }
  });


      li.appendChild(deleteBtn);
    }

    results.appendChild(li);
  });
}

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  if (input.value.trim() !== "") {
    await addDoc(collection(db, "propositions"), { text: input.value });
    input.value = "";
    displayAnswers();
  }
});

displayAnswers();

</script>

</body>
</html>



